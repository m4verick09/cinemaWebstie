<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" type="text/css" href="../css/Layout.css">
    <link rel="stylesheet" type="text/css" href="../css/ticket.css">
    <script rel="javascript" src="http://courses.cs.cityu.edu.hk/cs2204/cw3/cinemas.js"></script>
    <script src="../js/movies.js" ></script>    
    <title>Zing!</title>
  </head>

  <body>
    <header>
      <div id="logo">
        <img src="../Images/2.png" alt="Logo" title="Zing Logo" />
      </div>
      <h1 id="zing-cinema">ZING CINEMA</h1>
    </header>
    <div class="Nav">
      <ul>
        <li><a href="Index.html">Home</a></li>
        <li><a href="NowShowing.html">Now Showing</a></li>
        <li><a href="Tickets.html">Tickets</a></li>
      </ul>
    </div>
    <main>
      <div id="Tickets"> 
      </div>
    </main>
    <footer>
      @Copyright of resources belongs to the corresponding copyright owners.
      <br />
      Fair use for education purpose| <span><a href="Index.html">Home</a></span>
      <a href="Design.html">Design</a>
    </footer>
    <script>
      window.onload=ticketer();
      var data1 =getMovies();
      var data2 = getCinemas();
      function decipher(keys) {
        for (let i=0; i<keys.length;i++){
          if (keys.charAt(i)=="+"){
            keys = keys.replace(keys.charAt(i)," ");
          }
        }
        keys = keys.replace("%2C",", ");
        keys = keys.replace("%3A", ":");
        return keys;
      }
      function getData(data) {
        var query = window.location.search.substring(1);
        query = decipher(query);
        var datas = query.split("&");
        for (let i = 0;i< datas.length;i++){
          var pair = datas[i].split("=");
          if (pair[0]== data) {
            return pair[1];
          }
        }
        return null;
      }
      function ticketer (){
        var cn = getData('cinemaname');
        var movName= getData('moviename');
        var dt = getData('datetime');
        var house = getData('house');
        var seats = localStorage.getItem("seat");
        seats = seats.split(",")
        for (var j=0; j<seats.length;j++){
          var tick = document.createElement("div");
          tick.innerHTML=`
          <h2> Ticket ${j+1}</h2>
          <p>Cinema: ${cn}</p>
          <p>Movie Name: ${movName}</p>
          <p>Date & Time: ${dt}</p>
          <p>House: ${house}</p>
          <p>Seat: ${seats[j]}</p>
          `
          tick.setAttribute("class", print)
          document.getElementById("Tickets").append(tick)
        }
      }
    </script>
  </body>
</html>
